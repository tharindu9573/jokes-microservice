ARG RMQ_SUBMIT_URL
ARG RMQ_MODERATE_URL
ARG SM_QUEUE_NAME
ARG MOD_QUEUE_NAME
ARG AN_QUEUE_NAME
ARG SM_CONTAINER_PORT
ARG MOD_CONTAINER_PORT
ARG PORT
ARG MYSQL_URL
ARG MYSQL_ROOT_PASSWORD
ARG USERNAME
ARG PASSWORD
ARG JWT_SECRET
ARG GW_URL
ARG GW_PORT
ARG SERVICE_NAME

FROM node:slim

ENV NODE_ENV development
ENV RMQ_SUBMIT_URL=$RMQ_SUBMIT_URL
ENV RMQ_MODERATE_URL=$RMQ_MODERATE_URL
ENV SM_QUEUE_NAME=$SM_QUEUE_NAME
ENV MOD_QUEUE_NAME=$MOD_QUEUE_NAME
ENV AN_QUEUE_NAME=$AN_QUEUE_NAME
ENV SM_CONTAINER_PORT=$SM_CONTAINER_PORT
ENV MOD_CONTAINER_PORT=$MOD_CONTAINER_PORT
ENV PORT=$PORT
ENV MYSQL_URL=$MYSQL_URL
ENV MYSQL_ROOT_PASSWORD=$MYSQL_ROOT_PASSWORD
ENV USERNAME=$USERNAME
ENV PASSWORD=$PASSWORD
ENV JWT_SECRET=$JWT_SECRET
ENV GW_URL=$GW_URL
ENV GW_PORT=$GW_PORT
ENV SERVICE_NAME=$SERVICE_NAME

WORKDIR /express-docker

COPY . .

RUN npm install

CMD ["npm", "start"]

EXPOSE 3100